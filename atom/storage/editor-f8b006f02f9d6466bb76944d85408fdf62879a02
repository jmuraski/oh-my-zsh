{"mode":"editor","version":1,"windowDimensions":{"x":250,"y":250,"width":2217,"height":1100,"maximized":false},"grammars":{"deserializer":"GrammarRegistry","grammarOverridesByPath":{}},"project":{"paths":["/Users/jmuraski/Documents/workspace/Commerce-UI"],"buffers":[{"text":"package com.bestbuy.filter;\n\nimport com.bestbuy.ce.config.CORSFilterConfig;\nimport org.springframework.stereotype.Component;\nimport org.springframework.web.filter.OncePerRequestFilter;\n\nimport javax.annotation.Resource;\nimport javax.servlet.FilterChain;\nimport javax.servlet.ServletException;\nimport javax.servlet.http.HttpServletRequest;\nimport javax.servlet.http.HttpServletResponse;\nimport java.io.IOException;\n\n@Component\npublic class CORSFilter extends OncePerRequestFilter {\n\n    private String allowedOrigin;\n\n\t@Override\n\tprotected void doFilterInternal(HttpServletRequest request,\n\t\t\tHttpServletResponse response, FilterChain filterChain)\n\t\t\tthrows ServletException, IOException {\n\t\t//API\n\t\tString urlPath = request.getRequestURI();\n\t\tif(urlPath.contains(\"/api\")){\n            String requestMethod = request.getMethod();\n            if (\"OPTIONS\".equals(requestMethod) || \"GET\".equals(requestMethod) || \"POST\".equals(requestMethod)) {\n                String referrer = request.getHeader(\"referer\");\n                if (!CORSFilterConfig.PILOT.equals(allowedOrigin) ||\n                    (referrer != null && referrer.startsWith(CORSFilterConfig.PILOT))) {\n                    response.setHeader(\"Access-Control-Allow-Origin\", allowedOrigin);\n                    response.setHeader(\"Access-Control-Allow-Headers\", \"x-requested-with, content-type\");\n                }\n\t\t\t}\n\t\t}\n\t\tfilterChain.doFilter(request, response);\n\t}\n\n    @Resource\n    public void setAllowedOrigin(String allowedOrigin) {\n        this.allowedOrigin = allowedOrigin;\n    }\n}\n","markers":{"markers":{"1":{"id":1,"range":[[0,0],[0,0]],"tailed":false,"reversed":false,"valid":true,"invalidate":"never","persistent":true,"properties":{"type":"selection","editorId":4},"deserializer":"Marker"}},"deserializer":"MarkerManager"},"history":{"undoStack":[],"redoStack":[],"deserializer":"History"},"encoding":"utf8","filePath":"/Users/jmuraski/Documents/workspace/Commerce-UI/commerceui/src/main/java/com/bestbuy/filter/CORSFilter.java","modifiedWhenLastPersisted":false,"digestWhenLastPersisted":"a3d8497fe39c7d748362381007474e3b5b6713b4","deserializer":"TextBuffer"},{"text":"# this file is loaded by property placeholder config (spring)\nce.bbyopen.productdetails.pid.url=https://api.bbyremix.bestbuy.com/v1/products/{sku}.json?apiKey={apiKey}&LID={affiliateId}\nce.bbyopen.productdetails.url=https://api.bbyremix.bestbuy.com/v1/products/{sku}.json?apiKey={apiKey}\nce.bbyopen.store.url=https://api.bbyremix.bestbuy.com/v1/stores({storeIds})?apiKey={apiKey}&format=json\nce.bbyopen.apikey=z4r9g67b6n5cvf2zsezd4wrt\nce.capi.apikey=comapi\nce.capi.bootstrap.url=https://commerce.qa.bestbuy.com/commerce/v0/start?apiKey={apiKey}\nce.partner.management.partner.url=https://bbypartner.stage.bestbuy.com/api/partner/{partnerId}?apiKey={apiKey}\nce.partner.management.partner.affiliate.url=https://bbypartner.stage.bestbuy.com/api/partner/findByPartnerAffiliateId?partnerAffiliateId={affiliateId}&apiKey={apiKey}\nce.partner.management.api.key=dc9eddd0-2fe6-4ad4-8c0f-6a8da514dde8","markers":{"markers":{"1":{"id":1,"range":[[0,0],[0,0]],"tailed":false,"reversed":false,"valid":true,"invalidate":"never","persistent":true,"properties":{"type":"selection","editorId":8},"deserializer":"Marker"}},"deserializer":"MarkerManager"},"history":{"undoStack":[],"redoStack":[],"deserializer":"History"},"encoding":"utf8","filePath":"/Users/jmuraski/Documents/workspace/Commerce-UI/commerceui/src/main/resources/commerceui_qa.properties","modifiedWhenLastPersisted":false,"digestWhenLastPersisted":"0c589ed870e3c47c86275330ffbf1e418f123ec7","deserializer":"TextBuffer"},{"text":"application.version=${pom.version}\nce.capi.address.validation.sku=43900","markers":{"markers":{"1":{"id":1,"range":[[0,0],[0,0]],"tailed":false,"reversed":false,"valid":true,"invalidate":"never","persistent":true,"properties":{"type":"selection","editorId":12},"deserializer":"Marker"}},"deserializer":"MarkerManager"},"history":{"undoStack":[],"redoStack":[],"deserializer":"History"},"encoding":"utf8","filePath":"/Users/jmuraski/Documents/workspace/Commerce-UI/commerceui/src/main/resources/commerceui_global.properties","modifiedWhenLastPersisted":false,"digestWhenLastPersisted":"1c71b92e705bc79d091be9a9031e7d36e3663a6b","deserializer":"TextBuffer"},{"text":"<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<beans xmlns=\"http://www.springframework.org/schema/beans\"\n\txmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:oxm=\"http://www.springframework.org/schema/oxm\"\n\txmlns:util=\"http://www.springframework.org/schema/util\" xmlns:mvc=\"http://www.springframework.org/schema/mvc\"\n\txmlns:context=\"http://www.springframework.org/schema/context\"\n\txsi:schemaLocation=\"http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd\n\t\t\t\t\t\t\thttp://www.springframework.org/schema/mvc http://www.springframework.org/schema/mvc/spring-mvc-3.0.xsd\n\t\t\t\t\t\t\thttp://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.0.xsd\n\t\t\t\t\t\t\thttp://www.springframework.org/schema/oxm\n\t\t\t\t\t\t\thttp://www.springframework.org/schema/oxm/spring-oxm-3.0.xsd\n\t\t\t\t\t\t\thttp://www.springframework.org/schema/util\n  \t\t\t\t\t\t\thttp://www.springframework.org/schema/util/spring-util-3.0.xsd\">\n\n\t<context:component-scan base-package=\"com.bestbuy.ce\" />\n    <context:component-scan base-package=\"com.bestbuy.filter\" />\n\t<context:annotation-config />\n\n    <!--  for testing purposes only.  I created this block, which is not injected by default (tests can override the default) because\n        the CAPI SSL certificate is not valid.  Using this alternate configuration (a horrible practice) allows the connection to proceed\n        even though the cert is not valid.  DO NOT USE THIS FOR PRODUCTION!!!!! -->\n    <bean id=\"schemeRegistryInsecure\" class=\"com.bestbuy.ce.spring.InsecureSchemeRegistryFactoryBean\"/>\n\n\n    <!--  Configuration can also be found in com.bestbuy.ce.config.BaseAppConfig.class  -->\n\n\t<import resource=\"commerceui/commerceui-ce-maps.xml\" />\n</beans>\n","markers":{"markers":{"1":{"id":1,"range":[[0,0],[0,0]],"tailed":false,"reversed":false,"valid":true,"invalidate":"never","persistent":true,"properties":{"type":"selection","editorId":16},"deserializer":"Marker"}},"deserializer":"MarkerManager"},"history":{"undoStack":[],"redoStack":[],"deserializer":"History"},"encoding":"utf8","filePath":"/Users/jmuraski/Documents/workspace/Commerce-UI/commerceui/src/main/webapp/WEB-INF/conf/root-context.xml","modifiedWhenLastPersisted":false,"digestWhenLastPersisted":"88ddd78f696a05a5be223718315d1f788fea35dd","deserializer":"TextBuffer"},{"text":"package com.bestbuy.ce.config;\n\npublic class AvailableEnvironment {\n    public static final String LOCAL = \"local\";\n    public static final String PRODUCTION = \"prod\";\n    public static final String STAGE = \"stage\";\n    public static final String DEVELOPMENT = \"dev\";\n    public static final String QA = \"qa\";\n}\n","markers":{"markers":{"1":{"id":1,"range":[[0,0],[0,0]],"tailed":false,"reversed":false,"valid":true,"invalidate":"never","persistent":true,"properties":{"type":"selection","editorId":20},"deserializer":"Marker"}},"deserializer":"MarkerManager"},"history":{"undoStack":[],"redoStack":[],"deserializer":"History"},"encoding":"utf8","filePath":"/Users/jmuraski/Documents/workspace/Commerce-UI/commerceui/src/main/java/com/bestbuy/ce/config/AvailableEnvironment.java","modifiedWhenLastPersisted":false,"digestWhenLastPersisted":"1c48b3abf630ebbf301534bdb85413aa7f6bd25b","deserializer":"TextBuffer"},{"text":"package com.bestbuy.ce.config;\n\nimport org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\nimport org.springframework.beans.BeansException;\nimport org.springframework.context.ApplicationContext;\nimport org.springframework.context.ApplicationContextAware;\n\nimport java.util.Arrays;\nimport java.util.List;\n\npublic abstract class BaseAppConfig implements ApplicationContextAware{\n\n    protected static final Logger LOG = LoggerFactory.getLogger(BaseAppConfig.class);\n    protected ApplicationContext applicationContext;\n    protected List<String> profiles;\n\n    public void setApplicationContext(ApplicationContext applicationContext) throws BeansException {\n        this.applicationContext = applicationContext;\n    }\n\n    protected boolean isProfile(String profile){\n        if(profiles == null){\n            loadProfiles();\n        }\n        return profiles != null && profiles.contains(profile);\n    }\n\n    protected void loadProfiles() {\n        profiles = Arrays.asList(applicationContext.getEnvironment().getActiveProfiles());\n        StringBuffer profileStrings = new StringBuffer(\"++++++++++++++++++++++++++++        Current Profiles are: \");\n\n        for (String profile : profiles) {\n            profileStrings.append(profile).append(\" \");\n        }\n\n        profileStrings.append(\" +++++++++++++++++++++++++++\");\n\n        LOG.info(profileStrings.toString());\n    }\n}\n","markers":{"markers":{"1":{"id":1,"range":[[0,0],[0,0]],"tailed":false,"reversed":false,"valid":true,"invalidate":"never","persistent":true,"properties":{"type":"selection","editorId":24},"deserializer":"Marker"}},"deserializer":"MarkerManager"},"history":{"undoStack":[],"redoStack":[],"deserializer":"History"},"encoding":"utf8","filePath":"/Users/jmuraski/Documents/workspace/Commerce-UI/commerceui/src/main/java/com/bestbuy/ce/config/BaseAppConfig.java","modifiedWhenLastPersisted":false,"digestWhenLastPersisted":"66448221bc89f53ae9cfca9bf2bb70499b36e52b","deserializer":"TextBuffer"},{"text":"package com.bestbuy.ce.config;\n\nimport org.springframework.context.annotation.Bean;\nimport org.springframework.context.annotation.Configuration;\n\n@Configuration\npublic class CORSFilterConfig extends BaseAppConfig {\n\n    public static String PILOT = \"http://plt-images-pls.bestbuy.com\";\n\n    @Bean\n    public String allowedOrigin(){\n        if (isProfile(AvailableEnvironment.PRODUCTION)) {\n            return PILOT;\n        } else {\n            return \"*\";\n        }\n    }\n}\n","markers":{"markers":{"1":{"id":1,"range":[[15,12],[15,23]],"tailed":true,"reversed":true,"valid":true,"invalidate":"never","persistent":true,"properties":{"type":"selection","editorId":28,"goalBufferRange":null},"deserializer":"Marker"}},"deserializer":"MarkerManager"},"history":{"undoStack":[],"redoStack":[],"deserializer":"History"},"encoding":"utf8","filePath":"/Users/jmuraski/Documents/workspace/Commerce-UI/commerceui/src/main/java/com/bestbuy/ce/config/CORSFilterConfig.java","modifiedWhenLastPersisted":false,"digestWhenLastPersisted":"afb780b4e72b013f12a074cf215c90e9da5a184e","deserializer":"TextBuffer"}],"deserializer":"Project"},"workspace":{"paneContainer":{"root":{"id":3,"items":[{"id":4,"softTabs":true,"displayBuffer":{"id":5,"softWrapped":false,"editorWidthInChars":null,"scrollTop":0,"scrollLeft":0,"tokenizedBuffer":{"bufferPath":"/Users/jmuraski/Documents/workspace/Commerce-UI/commerceui/src/main/java/com/bestbuy/filter/CORSFilter.java","invisibles":{"eol":"¬","space":"·","tab":"»","cr":"¤"},"deserializer":"TokenizedBuffer"},"invisibles":{"eol":"¬","space":"·","tab":"»","cr":"¤"},"deserializer":"DisplayBuffer"},"deserializer":"TextEditor"},{"id":8,"softTabs":true,"displayBuffer":{"id":9,"softWrapped":false,"editorWidthInChars":null,"scrollTop":0,"scrollLeft":0,"tokenizedBuffer":{"bufferPath":"/Users/jmuraski/Documents/workspace/Commerce-UI/commerceui/src/main/resources/commerceui_qa.properties","invisibles":{"eol":"¬","space":"·","tab":"»","cr":"¤"},"deserializer":"TokenizedBuffer"},"invisibles":{"eol":"¬","space":"·","tab":"»","cr":"¤"},"deserializer":"DisplayBuffer"},"deserializer":"TextEditor"},{"id":12,"softTabs":true,"displayBuffer":{"id":13,"softWrapped":false,"editorWidthInChars":null,"scrollTop":0,"scrollLeft":0,"tokenizedBuffer":{"bufferPath":"/Users/jmuraski/Documents/workspace/Commerce-UI/commerceui/src/main/resources/commerceui_global.properties","invisibles":{"eol":"¬","space":"·","tab":"»","cr":"¤"},"deserializer":"TokenizedBuffer"},"invisibles":{"eol":"¬","space":"·","tab":"»","cr":"¤"},"deserializer":"DisplayBuffer"},"deserializer":"TextEditor"},{"id":16,"softTabs":false,"displayBuffer":{"id":17,"softWrapped":false,"editorWidthInChars":null,"scrollTop":0,"scrollLeft":0,"tokenizedBuffer":{"bufferPath":"/Users/jmuraski/Documents/workspace/Commerce-UI/commerceui/src/main/webapp/WEB-INF/conf/root-context.xml","invisibles":{"eol":"¬","space":"·","tab":"»","cr":"¤"},"deserializer":"TokenizedBuffer"},"invisibles":{"eol":"¬","space":"·","tab":"»","cr":"¤"},"deserializer":"DisplayBuffer"},"deserializer":"TextEditor"},{"id":20,"softTabs":true,"displayBuffer":{"id":21,"softWrapped":false,"editorWidthInChars":null,"scrollTop":0,"scrollLeft":0,"tokenizedBuffer":{"bufferPath":"/Users/jmuraski/Documents/workspace/Commerce-UI/commerceui/src/main/java/com/bestbuy/ce/config/AvailableEnvironment.java","invisibles":{"eol":"¬","space":"·","tab":"»","cr":"¤"},"deserializer":"TokenizedBuffer"},"invisibles":{"eol":"¬","space":"·","tab":"»","cr":"¤"},"deserializer":"DisplayBuffer"},"deserializer":"TextEditor"},{"id":24,"softTabs":true,"displayBuffer":{"id":25,"softWrapped":false,"editorWidthInChars":null,"scrollTop":0,"scrollLeft":0,"tokenizedBuffer":{"bufferPath":"/Users/jmuraski/Documents/workspace/Commerce-UI/commerceui/src/main/java/com/bestbuy/ce/config/BaseAppConfig.java","invisibles":{"eol":"¬","space":"·","tab":"»","cr":"¤"},"deserializer":"TokenizedBuffer"},"invisibles":{"eol":"¬","space":"·","tab":"»","cr":"¤"},"deserializer":"DisplayBuffer"},"deserializer":"TextEditor"},{"id":28,"softTabs":true,"displayBuffer":{"id":29,"softWrapped":false,"editorWidthInChars":null,"scrollTop":0,"scrollLeft":0,"tokenizedBuffer":{"bufferPath":"/Users/jmuraski/Documents/workspace/Commerce-UI/commerceui/src/main/java/com/bestbuy/ce/config/CORSFilterConfig.java","invisibles":{"eol":"¬","space":"·","tab":"»","cr":"¤"},"deserializer":"TokenizedBuffer"},"invisibles":{"eol":"¬","space":"·","tab":"»","cr":"¤"},"deserializer":"DisplayBuffer"},"deserializer":"TextEditor"}],"activeItemURI":"/Users/jmuraski/Documents/workspace/Commerce-UI/commerceui/src/main/java/com/bestbuy/ce/config/CORSFilterConfig.java","focused":false,"deserializer":"Pane"},"activePaneId":3,"deserializer":"PaneContainer","version":1},"fullScreen":false,"packagesWithActiveGrammars":["language-java","language-xml","language-hyperlink","language-todo"],"deserializer":"Workspace"},"packageStates":{"fuzzy-finder":{"/Users/jmuraski/Documents/workspace/Commerce-UI/commerceui/src/main/java/com/bestbuy/filter/CORSFilter.java":1422043724676,"/Users/jmuraski/Documents/workspace/Commerce-UI/commerceui/src/main/resources/commerceui_qa.properties":1422043778853,"/Users/jmuraski/Documents/workspace/Commerce-UI/commerceui/src/main/resources/commerceui_global.properties":1422043802693,"/Users/jmuraski/Documents/workspace/Commerce-UI/commerceui/src/main/webapp/WEB-INF/conf/root-context.xml":1422043819275,"/Users/jmuraski/Documents/workspace/Commerce-UI/commerceui/src/main/java/com/bestbuy/ce/config/AvailableEnvironment.java":1422043836361,"/Users/jmuraski/Documents/workspace/Commerce-UI/commerceui/src/main/java/com/bestbuy/ce/config/BaseAppConfig.java":1422043844583,"/Users/jmuraski/Documents/workspace/Commerce-UI/commerceui/src/main/java/com/bestbuy/ce/config/CORSFilterConfig.java":1422043852944},"metrics":{"sessionLength":4217706},"tree-view":{"directoryExpansionStates":{"commerceui":{"src":{"main":{"java":{"com":{"bestbuy":{"ce":{"config":{}},"controller":{},"filter":{}}}},"webapp":{"WEB-INF":{"conf":{"commerceui":{}}}}}}}},"selectedPath":"/Users/jmuraski/Documents/workspace/Commerce-UI/commerceui/src/main/java/com/bestbuy/ce/config/CORSFilterConfig.java","hasFocus":false,"attached":true,"scrollLeft":0,"scrollTop":0,"width":357}}}